---
- name: nvm ... install
  ansible.builtin.shell:
    cmd: curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash
    creates: "{{ ansible_env.HOME }}/.nvm/nvm.sh"
    executable: /usr/bin/bash

- name: nvm ... install node 22
  ansible.builtin.shell:
    cmd: |
      export NVM_DIR="$HOME/.nvm"
      [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
      nvm install 22
      nvm use 22
      nvm alias default 22
    executable: /usr/bin/bash
  environment:
    HOME: "{{ ansible_env.HOME }}"

- name: nvm ... install pnpm
  ansible.builtin.shell:
    cmd: npm install -g pnpm
    executable: /usr/bin/bash
